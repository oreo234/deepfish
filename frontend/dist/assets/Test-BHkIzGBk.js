import{_ as e,u as a,a as s,f as l,b as i,r as t,k as n,w as g,F as r,g as u,E as o,o as m,l as p,j as c}from"./index-rHRo5HIh.js";import{f as I}from"./index-proxR6sI.js";const d={class:"test-container"},B={class:"content-area"},h={class:"upload-section"},C={key:0,class:"preview-area"},f=["src"],A={class:"sample-images"},E={class:"samples"},O=["onClick"],w=["src","alt"],v={class:"result-section"},y={key:0,class:"no-result"},D={key:1,class:"result-content"},j={class:"result-image-container"},b=["src"],N={class:"result-details"},L={class:"result-footer"},F={class:"inference-time"},S={class:"model-info"};const W=e({name:"TestPage",components:{UploadFilled:a},data:()=>({imageUrl:"",imageFile:null,uploadedImageId:null,predictType:"yolo_public_model",loading:!1,result:null,resultImageUrl:"",classNameMap:{AngelFish:"神仙鱼 (Pterophyllum scalare)",BlueTang:"蓝吊 (Paracanthurus hepatus)",ButterflyFish:"蝶鱼 (Chaetodontidae)",ClownFish:"小丑鱼 (Amphiprioninae)",GoldFish:"金鱼 (Carassius auratus)",Gourami:"丝足鱼/吻鱼 (Osphronemidae)",MorishIdol:"莫里什神仙鱼 (Zanclidae)",PlatyFish:"月光鱼/剑尾鱼 (Xiphophorus maculatus)",RibbonedSweetlips:"丝鳢/花唇鱼 (Plectorhinchus polytaenia)",ThreeStripedDamselfish:"三带豆娘 (Dascyllus aruanus)",YellowCichlid:"黄慈鲷 (Labidochromis caeruleus)",YellowTang:"黄吊 (Zebrasoma flavescens)",ZebraFish:"斑马鱼 (Danio rerio)"},sampleImageDefs:[{fileName:"介绍模型 (0).png",name:"AngelFish（神仙鱼）"},{fileName:"介绍模型 (1).png",name:"BlueTang（蓝吊）"},{fileName:"介绍模型 (2).png",name:"ButterflyFish（蝴蝶鱼）"},{fileName:"介绍模型 (3).png",name:"ClownFish（小丑鱼）"},{fileName:"介绍模型 (4).png",name:"GoldFish（金鱼）"},{fileName:"介绍模型 (5).png",name:"Gourami（丝足鲈 / 斗鱼）"},{fileName:"介绍模型 (6).png",name:"MorishIdol（镰鱼 / 神像鱼）"},{fileName:"介绍模型 (7).png",name:"PlatyFish（月光鱼）"},{fileName:"介绍模型 (8).png",name:"RibbonedSweetlips（丝带石鲈）"},{fileName:"介绍模型 (9).png",name:"ThreeStripedDamselfish（三带雀鲷）"},{fileName:"介绍模型 (10).png",name:"YellowCichlid（黄慈鲷）"},{fileName:"介绍模型 (11).png",name:"YellowTang（黄吊）"},{fileName:"介绍模型 (12).png",name:"ZebraFish（斑马鱼）"}]}),computed:{confidenceColor(){var e;const a=(null==(e=this.result)?void 0:e.confidence)||0;return a>.8?"#67C23A":a>.5?"#E6A23C":"#F56C6C"},percentageFormat:()=>e=>`${e}%`,sampleImages(){return this.sampleImageDefs.map(e=>({name:e.name,url:new URL(Object.assign({"../assets/fasterrcnn_training_loss_curve.png":"/assets/fasterrcnn_training_loss_curve-C07Dlopa.png","../assets/fasterrcnn结果.jpg":"/assets/fasterrcnn%E7%BB%93%E6%9E%9C-DOhcF2WM.jpg","../assets/fish.mp4":"/assets/fish-CLXURXy-.mp4","../assets/retinanet_training_loss_curve.png":"/assets/retinanet_training_loss_curve-Bh85L1ud.png","../assets/介绍模型 (0).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(0)-BbPlKneT.png","../assets/介绍模型 (1).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(1)-CXqF_K3a.png","../assets/介绍模型 (10).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(10)-BNDZZA-4.png","../assets/介绍模型 (11).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(11)-Dy1VVgQy.png","../assets/介绍模型 (12).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(12)-CYoNJPAL.png","../assets/介绍模型 (2).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(2)-BYfdhYPC.png","../assets/介绍模型 (3).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(3)-CxKz_tYg.png","../assets/介绍模型 (4).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(4)-CRFtzE7c.png","../assets/介绍模型 (5).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(5)-CU9HCATO.png","../assets/介绍模型 (6).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(6)-CSnKSakE.png","../assets/介绍模型 (7).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(7)-DSZ7NX0u.png","../assets/介绍模型 (8).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(8)-BkHeA3Rj.png","../assets/介绍模型 (9).png":"/assets/%E4%BB%8B%E7%BB%8D%E6%A8%A1%E5%9E%8B%20(9)-Cpk0vqzg.png","../assets/整理好的对比数据.xlsx":"/assets/%E6%95%B4%E7%90%86%E5%A5%BD%E7%9A%84%E5%AF%B9%E6%AF%94%E6%95%B0%E6%8D%AE-Rce8EeJ9.xlsx","../assets/模型对比.md":"data:text/markdown;base64,IyDmqKHlnovmgKfog73lr7nmr5TkuI7mjIfmoIfor7TmmI4NCg0KIyMg5LiA44CB5qih5Z6L5oCn6IO95a+55q+UDQoNCnwg5qih5Z6L5ZCN56ewIHwgbUFQQDAuNSB8IG1BUEAwLjU6MC45NSB8IFByZWNpc2lvbiB8IFJlY2FsbCB8IEYxLVNjb3JlIHwgQm94IExvc3MgfCBDbHMgTG9zcyB8IOeUqOaXtu+8iG1pbjpzZWPvvIkgfA0KfCAtLS0gfCAtLS0gfCAtLS0gfCAtLS0gfCAtLS0gfCAtLS0gfCAtLS0gfCAtLS0gfCAtLS0gfA0KfCBZT0xPIHwgMC44NTM2IHwgMC42NzI2IHwgMC44MzMgfCAwLjgzNTEgfCAwLjgzNCB8IDAuMCB8IDAuMCB8IDAxOjE1OjAwIHwNCnwgRmFzdGVyIFItQ05OIHwgMC42MTYzIHwgMC43NDI1IHwgMC42NzUyIHwgMC44ODk1IHwgMC43Njc3IHwgMC4wIHwgMC4wIHwgMTM6Mjc6MDAgfA0KfCBSZXRpbmFOZXQgfCAwLjU3NjIgfCAwLjYyNTkgfCAwLjgzNzcgfCAwLjY1MzUgfCAwLjczNDIgfCAwLjAgfCAwLjAgfCAwOTo0ODowMCB8DQoNCiMjIOS6jOOAgeaMh+agh+ivtOaYjg0KDQp8IOaMh+aghyB8IOWFqOensCB8IOWQq+S5ieivtOaYjiB8IOe7k+iuuumhuSB8IOaAu+e7kyB8DQp8IC0tLSB8IC0tLSB8IC0tLSB8IC0tLSB8IC0tLSB8DQp8IOaMh+aghyB8IOWFqOensCB8IOWQq+S5ieivtOaYjiB8ICB8ICB8DQp8IG1BUEAwLjUgfCBNZWFuIEF2ZXJhZ2UgUHJlY2lzaW9uIGF0IElvVSA9IDAuNSB8IOWcqOS6pOW5tuavlCAoSW9VKSDiiaUgMC41IOaXtu+8jOaJgOacieexu+WIq+eahOW5s+Wdh+ajgOa1i+eyvuW6puWdh+WAvOOAguWPjeaYoOajgOa1i+ahhuS9jee9ruWHhuehruaAp+OAguaVsOWAvOi2iumrmOi2iuWlveOAgiB8IOe7k+iuuumhuSB8IOaAu+e7kyB8DQp8IG1BUEAwLjU6MC45NSB8IE1lYW4gQXZlcmFnZSBQcmVjaXNpb24gYXZlcmFnZWQgb3ZlciBJb1UgdGhyZXNob2xkcyAoMC414oCTMC45NSkgfCDlnKggSW9VIDAuNX4wLjk177yI5q2l6ZW/MC4wNe+8ieeahOWMuumXtOS4iuW5s+Wdh+eahCBtQVDvvIzooaHph4/mqKHlnovlr7nkuI3lkIznsr7luqbopoHmsYLkuIvnmoTnu7zlkIjmo4DmtYvog73lipvvvIzmm7TkuKXmoLzjgIHmm7TlhajpnaLjgIIgfCDnsr7luqbooajnjrDmnIDkvJggfCBZT0xP77yIbUFQQDAuNSA9IDAuODXvvInmlbTkvZPmo4DmtYvnsr7luqbmnIDpq5jjgIIgfA0KfCBQcmVjaXNpb27vvIjnsr7noa7njofvvIkgfCBUUCAvIChUUCArIEZQKSB8IOihqOekuumihOa1i+S4uuato+eahOagt+acrOS4reacieWkmuWwkeaYr+ecn+ato+eahOato+agt+acrOOAgumrmOeyvuW6puaEj+WRs+edgOivr+aKpeWwkeOAgiB8IOWPrOWbnueOh+acgOmrmCB8IEZhc3RlciBSLUNOTu+8iFJlY2FsbCA9IDAuODg5Ne+8ieajgOa1i+WIsOeahOebruagh+acgOWkmu+8jOS9humAn+W6puacgOaFouOAgiB8DQp8IFJlY2FsbO+8iOWPrOWbnueOh++8iSB8IFRQIC8gKFRQICsgRk4pIHwg6KGo56S65omA5pyJ5q2j5qC35pys5Lit5pyJ5aSa5bCR6KKr5q2j56Gu5qOA5rWL5Ye65p2l44CC6auY5Y+s5Zue5oSP5ZGz552A5ryP5qOA5bCR44CCIHwg6YCf5bqm5pyA5b+rIHwgWU9MT++8iDHliIYxNeenkuWujOaIkOa1i+ivle+8ie+8jOaViOeOh+aYvuiRl+mrmOS6juWFtuS7luS4pOenjeaooeWei+OAgiB8DQp8IEYxLVNjb3JlIHwgMsOXKFByZWNpc2lvbsOXUmVjYWxsKS8oUHJlY2lzaW9uK1JlY2FsbCkgfCDnu7zlkIjlubPooaEgUHJlY2lzaW9uIOS4jiBSZWNhbGwg55qE6LCD5ZKM5bmz5Z2H5pWw77yM55So5LqO5pW05L2T5oCn6IO96K+E5Lyw44CCIHwg5bmz6KGh5oCn6L6D5aW9IHwgWU9MTyDlnKjnsr7luqbjgIHlj6zlm57kuI7pgJ/luqbkuIrooajnjrDlnYfooaHjgIIgfA0KfCBCb3ggTG9zcyB8IEJvdW5kaW5nIEJveCBMb3NzIHwg6KGo56S65qih5Z6L5Zyo6aKE5rWL6L655qGG5L2N572u5pe255qE6K+v5beu77yM5YC86LaK5bCP6K+05piO5qGG5a6a5L2N5pu05YeG56Gu44CCIHwgIHwgIHwNCnwgQ2xzIExvc3MgfCBDbGFzc2lmaWNhdGlvbiBMb3NzIHwg6KGo56S65qih5Z6L5Zyo5YiG57G777yI6K+G5Yir57G75Yir77yJ5pe255qE5o2f5aSx77yM5YC86LaK5bCP6K+05piO5YiG57G76LaK5YeG56Gu44CCIHwgIHwgIHwNCnwg55So5pe2IHwgRXZhbHVhdGlvbiBUaW1lIHwg5qih5Z6L5Zyo5rWL6K+V6ZuG5LiK5a6M5oiQ5LiA5qyh5a6M5pW06K+E5Lyw5omA6ZyA55qE5pe26Ze077yM5qC85byP5Li65YiG6ZKfOuenkuOAgui2iuefreivtOaYjuaOqOeQhuaViOeOh+i2iumrmOOAgiB8ICB8ICB8DQo=","../assets/训练过程图.png":"/assets/%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B%E5%9B%BE-CDMi7R3J.png"})[`../assets/${e.fileName}`],import.meta.url).href}))}},methods:{goBack(){this.$router.push("/")},async handleFileChange(e){var a;if(!e)return;const s=(null==(a=e.raw)?void 0:a.type)||"";if(["image/jpeg","image/png","image/gif"].includes(s)){this.imageFile=e.raw,this.imageUrl=URL.createObjectURL(e.raw),this.result=null,this.resultImageUrl="",this.uploadedImageId=null;try{const a=await I.uploadImage(e.raw);a&&a.id?(this.uploadedImageId=a.id,o.success(`图片上传成功，ID: ${a.id}`)):o.warning("上传成功，但未返回图片ID")}catch(l){o.error("图片上传失败，请稍后重试")}}else o.error("只能上传JPG、PNG或GIF格式的图片!")},async useSampleImage(e){this.imageUrl=e,this.imageFile=null,this.result=null,this.resultImageUrl="",this.uploadedImageId=null;try{const a=await fetch(e),s=await a.blob(),l=new File([s],"sample.jpg",{type:s.type||"image/jpeg"}),i=await I.uploadImage(l);i&&i.id?(this.uploadedImageId=i.id,o.success(`样例图片上传成功，ID: ${i.id}`)):o.warning("样例图片上传成功，但未返回图片ID")}catch(a){o.error("样例图片上传失败，请稍后重试")}},async detectFish(){var e,a,s,l,i,t;if(this.imageUrl){if(!this.uploadedImageId)try{let e=this.imageFile;if(!e&&this.imageUrl.startsWith("/")){const a=await fetch(this.imageUrl),s=await a.blob();e=new File([s],"sample.jpg",{type:s.type||"image/jpeg"})}if(e){const a=await I.uploadImage(e);a&&a.id&&(this.uploadedImageId=a.id,o.success(`图片重新上传成功，ID: ${a.id}`))}}catch(n){}if(this.uploadedImageId){this.loading=!0;try{const n=performance.now(),g=await I.predictById(this.uploadedImageId,this.predictType),r=(performance.now()-n)/1e3,u=this.classNameMap[null==(a=null==(e=null==g?void 0:g.detections)?void 0:e[0])?void 0:a.class_name]||(null==(l=null==(s=null==g?void 0:g.detections)?void 0:s[0])?void 0:l.class_name)||"未知鱼类",o=Number((null==(t=null==(i=null==g?void 0:g.detections)?void 0:i[0])?void 0:t.confidence)||0);this.result={class:u,confidence:o,inference_time:Number(r.toFixed(3)),model:(null==g?void 0:g.predict_type)||this.predictType},(null==g?void 0:g.result_image_id)?this.resultImageUrl=I.getImageUrl(g.result_image_id):this.resultImageUrl=""}catch(g){o.error("识别请求失败，请稍后重试")}finally{this.loading=!1}}else o.error("缺少图片ID，无法执行识别。请重新上传图片。")}else o.warning("请先上传或选择图片")},resetTest(){this.imageUrl="",this.imageFile=null,this.uploadedImageId=null,this.result=null,this.resultImageUrl=""}}},[["render",function(e,a,o,I,W,M){const k=t("el-page-header"),U=t("upload-filled"),Y=t("el-icon"),H=t("el-upload"),Z=t("el-button"),G=t("el-empty"),K=t("el-tag"),q=t("el-descriptions-item"),_=t("el-progress"),z=t("el-descriptions"),T=t("el-statistic");return m(),s("div",d,[l(k,{onBack:M.goBack,title:"返回首页",content:"单张图片测试"},null,8,["onBack"]),i("div",B,[i("div",h,[l(H,{class:"upload-box",drag:"",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":M.handleFileChange},{default:g(()=>[l(Y,{class:"upload-icon"},{default:g(()=>[l(U)]),_:1}),a[0]||(a[0]=i("div",{class:"upload-text"},[i("span",null,"拖拽图片到此处或点击上传"),i("p",null,"支持 JPG、PNG、GIF 格式图片")],-1))]),_:1},8,["on-change"]),W.imageUrl?(m(),s("div",C,[i("img",{src:W.imageUrl,class:"preview-image"},null,8,f),l(Z,{type:"primary",onClick:M.detectFish,loading:W.loading},{default:g(()=>[...a[1]||(a[1]=[p("开始识别",-1)])]),_:1},8,["onClick","loading"])])):n("",!0),i("div",A,[a[2]||(a[2]=i("h3",null,"样例图片",-1)),i("div",E,[(m(!0),s(r,null,u(M.sampleImages,(e,a)=>(m(),s("div",{key:a,class:"sample-item",onClick:a=>M.useSampleImage(e.url)},[i("img",{src:e.url,alt:e.name},null,8,w),i("span",null,c(e.name),1)],8,O))),128))])])]),i("div",v,[W.result?(m(),s("div",D,[a[5]||(a[5]=i("h2",null,"识别结果",-1)),i("div",j,[i("img",{src:W.resultImageUrl||W.imageUrl,class:"result-image"},null,8,b)]),i("div",N,[l(z,{title:"鱼类信息",column:1,border:""},{default:g(()=>[l(q,{label:"鱼种类"},{default:g(()=>[l(K,{size:"large"},{default:g(()=>[p(c(W.result.class),1)]),_:1})]),_:1}),l(q,{label:"置信度"},{default:g(()=>[l(_,{percentage:Math.round(100*W.result.confidence),color:M.confidenceColor,format:M.percentageFormat},null,8,["percentage","color","format"])]),_:1})]),_:1})]),i("div",L,[i("div",F,[l(T,{title:"推理耗时",value:W.result.inference_time,precision:2},{suffix:g(()=>[...a[3]||(a[3]=[i("span",null,"秒",-1)])]),_:1},8,["value"])]),i("div",S,[l(K,{type:"info"},{default:g(()=>[p("模型: "+c(W.result.model),1)]),_:1})]),l(Z,{type:"primary",onClick:M.resetTest},{default:g(()=>[...a[4]||(a[4]=[p("再试一次",-1)])]),_:1},8,["onClick"])])])):(m(),s("div",y,[l(G,{description:"请上传图片并点击开始识别"})]))])])])}],["__scopeId","data-v-6a7a0612"]]);export{W as default};
